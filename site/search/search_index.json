{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"accmix","text":"<p>Accessibility Mixture Model toolkit: scan PWMs, compute accessibility-derived scores (s_l), annotate with TSS/conservation/TPM, and fit a Gaussian EM with logistic prior. Statistical details will be updated soon. </p> <p>Quick links:</p> <ul> <li>Install: see Installation</li> <li>CLI usage: see CLI</li> </ul> <p>Note: This project is under active development; interfaces may evolve.</p> <p>Figures shown in the paper can be regenerated by following the steps in Reproducibility.</p>"},{"location":"changelog/","title":"Changelog","text":"<p>All notable changes to this project will be documented here.</p> <ul> <li>Initial docs scaffolding (MkDocs, Read the Docs config)</li> </ul>"},{"location":"cli/","title":"CLI","text":"<p>The main entry point is <code>accmix</code> with these subcommands. Run <code>accmix &lt;cmd&gt; --help</code> for the authoritative list. Below are the parameters, defaults, and meanings.</p>"},{"location":"cli/#accmix-scan","title":"<code>accmix scan</code>","text":"<p>Scan a genome FASTA with a PWM and compute inner/outer scores.</p> <pre><code>accmix scan -f &lt;fasta&gt; -p &lt;pwm.txt&gt; [-o &lt;out_prefix&gt;] [options]\n</code></pre> <p>Options</p> <ul> <li><code>-f, --fasta PATH</code> (required): Genome FASTA (.fa/.fa.gz).</li> <li><code>-p, --pwm PATH</code> (required): PWM text file with columns Pos,A,C,G,T/U.</li> <li><code>-o, --out-prefix PATH</code>: Output prefix (default: <code>results/&lt;pwm&gt;.&lt;timestamp&gt;</code>).</li> <li><code>-M INT</code> (default 50): Inner half-width in bp.</li> <li><code>-N INT</code> (default 500): Outer half-width in bp; must be &gt; <code>M</code>.</li> <li><code>-A INT</code> (default 2_000_000): Keep top-A entries per strand.</li> <li><code>-B INT</code> (default 2_000_000): Keep bottom-B entries per strand.</li> <li><code>-g, --bg \"A,C,G,T\"</code>: Background base probabilities for LLR (overridden by <code>-G</code>).</li> <li><code>-G, --bg-from-fasta</code>: Estimate background from the provided FASTA.</li> </ul> <p>Outputs: <code>results/&lt;prefix&gt;_topA.tsv.gz</code>, <code>results/&lt;prefix&gt;_botB.tsv.gz</code>.</p>"},{"location":"cli/#accmix-annotate-acc","title":"<code>accmix annotate-acc</code>","text":"<p>Compute accessibility-derived <code>s_l</code> from AS native/fixed and PWM top table.</p> <pre><code>accmix annotate-acc -n &lt;ASnative&gt; -f &lt;ASfixed&gt; -t &lt;toptable&gt; [-o &lt;out&gt;] [options]\n</code></pre> <p>Options</p> <ul> <li><code>-n, --ASnative PATH</code> (required): AS native file (chr, position, strand, score, depth, motif info).</li> <li><code>-f, --ASfixed PATH</code> (required): AS fixed BED6 (chr, start, end, strand, score, depth).</li> <li><code>-t, --toptable PATH</code> (required): PWM scan top-table TSV.gz with inner/outer scores.</li> <li><code>-o, --out PATH</code>: Output parquet (default: <code>results/sl.&lt;timestamp&gt;.parquet</code>).</li> <li><code>-M INT</code> (default 50): Inner half-width used in scanning.</li> <li><code>-N INT</code> (default 500): Outer half-width used in scanning.</li> </ul> <p>Output: parquet with <code>s_l</code> per site.</p>"},{"location":"cli/#accmix-annotate-tss","title":"<code>accmix annotate-tss</code>","text":"<p>Add TSS proximity, conservation, and TPM annotations to sites.</p> <pre><code>accmix annotate-tss -i &lt;input.parquet&gt; [-o &lt;out&gt;] [options]\n</code></pre> <p>Options</p> <ul> <li><code>-i, --input-parquet PATH</code> (required): Input parquet (e.g., output of <code>annotate-acc</code>).</li> <li><code>-o, --out PATH</code>: Output parquet (default: <code>results/annotated.&lt;timestamp&gt;.parquet</code>).</li> <li><code>-r, --rna-seq-parquet PATH</code> (default <code>data/expression/ENCFF364YCB_HeLa_RNAseq_Transcripts_count_curated.parquet</code>): Transcript TPM parquet.</li> <li><code>-c, --phastcons-bed PATH</code> (default <code>data/conservation_score/phastCons100way1.bed</code>): phastCons BED for regional conservation.</li> <li><code>-p, --phastcons-parquet PATH</code> (default <code>data/conservation_score/hg38.phastCons100way.1.parquet</code>): Base-level phastCons scores.</li> <li><code>-y, --phylop-parquet PATH</code> (default <code>data/conservation_score/hg38.phyloP100way.1.parquet</code>): Base-level phyloP scores.</li> <li><code>-R, --reference TEXT</code> (default <code>GRCh38</code>): Reference genome name.</li> </ul> <p>Output: parquet with added TSS distance, conservation, and expression features.</p>"},{"location":"cli/#accmix-model","title":"<code>accmix model</code>","text":"<p>Fit Gaussian EM with logistic prior and write priors/posteriors plus model JSON.</p> <pre><code>accmix model -i &lt;annotated.parquet&gt; -o &lt;out_prefix&gt; -r &lt;RBP&gt; -m &lt;MotifID&gt; [options]\n</code></pre> <p>Options</p> <ul> <li><code>-i, --input-parquet PATH</code> (required): Annotated parquet with <code>id</code>, <code>s_l</code>, and features.</li> <li><code>-o, --out-prefix PATH</code>: Output prefix (default: <code>results/&lt;rbp&gt;_&lt;motif&gt;.&lt;timestamp&gt;</code>).</li> <li><code>-r, --rbp-name TEXT</code> (default <code>RBP</code>): RBP label for outputs.</li> <li><code>-m, --motif-id TEXT</code> (default <code>Motif</code>): Motif ID label for outputs.</li> <li><code>-F, --feat-cols TEXT</code>: Comma-separated feature names (default: built-in set).</li> <li><code>-s, --site-col TEXT</code> (default <code>id</code>): Site identifier column.</li> <li><code>-S, --s-col TEXT</code> (default <code>s_l</code>): Accessibility score column.</li> <li><code>-M, --mode TEXT</code> (default <code>em</code>): Modeling mode (currently only <code>em</code>).</li> </ul> <p>Outputs: <code>&lt;prefix&gt;.model.parquet</code> (priors/posteriors) and <code>&lt;prefix&gt;.model.json</code> (parameters).</p>"},{"location":"cli/#accmix-evaluate","title":"<code>accmix evaluate</code>","text":"<p>Evaluate fitted models against CLIP/PIP-seq using the model parquet directly.</p> <pre><code>accmix evaluate \\\n    -M &lt;model.parquet&gt; \\\n    -b &lt;CLIP.bed&gt; \\\n    -p &lt;PIPseq.parquet&gt; \\\n    -r &lt;RBP_Name&gt; \\\n    -m &lt;Motif_ID&gt; \\\n    -o results \\\n    [-L &lt;logo.png&gt;] [-t 1.0] [-R 50]\n</code></pre> <p>Options</p> <ul> <li><code>-M, --model-parquet PATH</code> (required): Parquet produced by <code>accmix model</code> (contains <code>prior_p</code>/<code>posterior_r</code>).</li> <li><code>-b, --clipseq-bed PATH</code> (required): CLIP-seq peaks BED.</li> <li><code>-p, --pipseq-parquet PATH</code> (required): PIP-seq parquet.</li> <li><code>-r, --rbp-name TEXT</code>: RBP label.</li> <li><code>-m, --motif-id TEXT</code>: Motif identifier.</li> <li><code>-o, --output-root PATH</code>: Output directory (default <code>results</code>).</li> <li><code>-L, --motif-logo PATH</code>: Optional motif logo for heatmaps.</li> <li><code>-t, --score-phastcons100-threshold FLOAT</code>: Conservation cutoff (default 1.0).</li> <li><code>-R, --motif-range INT</code>: Half-window around site for overlaps (default 50).</li> </ul> <p>Outputs: plots under <code>results/plots/</code>, logs and tables under <code>results/logs/</code>.</p>"},{"location":"data/","title":"Data","text":"<p>Example inputs referenced in the docs use the <code>data/</code> directory structure, e.g.:</p> <ul> <li><code>data/fasta/test.fa</code></li> <li><code>data/pwms/M00124_example.txt</code></li> <li><code>data/clipseq/ELAVL1_HeLa.bed</code></li> </ul> <p>For access to example datasets, refer to the data link in the repository README or contact the maintainers.</p>"},{"location":"development/","title":"Development","text":""},{"location":"development/#local-docs-preview","title":"Local docs preview","text":"<pre><code>pip install -r docs/requirements.txt\nmkdocs serve\n</code></pre>"},{"location":"development/#contributing","title":"Contributing","text":"<ul> <li>Open an issue before major changes</li> <li>Use feature branches and pull requests</li> <li>Keep docs and README in sync with CLI changes</li> </ul>"},{"location":"development/#releasing","title":"Releasing","text":"<ul> <li>Update changelog</li> <li>Tag releases in Git</li> <li>Build and upload to PyPI if applicable</li> </ul>"},{"location":"installation/","title":"Installation","text":""},{"location":"installation/#from-pypi","title":"From PyPI","text":"<pre><code>pip install accmix\n</code></pre>"},{"location":"installation/#from-source-editable","title":"From source (editable)","text":"<pre><code>git clone https://github.com/yangli04/RAD-seq_EM_model.git\ncd RAD-seq_EM_model\npip install -e .\n</code></pre>"},{"location":"installation/#build-docs-locally","title":"Build docs locally","text":"<pre><code>pip install -r docs/requirements.txt\nmkdocs serve\n</code></pre>"},{"location":"reproducibility/","title":"Reproducibility","text":"<p>This guide shows how to regenerate the figures and model outputs in this repository, including the batch scripts used for the full Midway3 run.</p>"},{"location":"reproducibility/#prerequisites","title":"Prerequisites","text":"<ul> <li>Install the package (PyPI or source). See Installation.</li> <li>Prepare data as described in Data. Paths below assume the repository layout (<code>data/</code> and <code>results/</code>).</li> </ul>"},{"location":"reproducibility/#end-to-end-workflow-single-motifrbp","title":"End-to-end workflow (single motif/RBP)","text":"<p>1) Scan PWM</p> <pre><code>accmix scan \\\n  -f data/fasta/test.fa \\\n  -p data/pwms/M00124_example.txt \\\n  -o results/M00124_example\n</code></pre> <p>2) Compute s_l (accessibility)</p> <pre><code>accmix annotate-acc \\\n  -n data/AS/ANC1C.hisat3n_table.bed6 \\\n  -f data/AS/ANC1xC.hisat3n_table.bed6 \\\n  -t results/M00124_example_topA.tsv.gz \\\n  -o results/M00124_example_sl.parquet \\\n  --M 50 --N 500\n</code></pre> <p>3) Annotate TSS / conservation / TPM</p> <pre><code>accmix annotate-tss \\\n  -i results/M00124_example_sl.parquet \\\n  -o results/M00124_example_annotated.parquet \\\n  -r data/evaluation/RNAseq_HeLa_TPM.parquet \\\n  -c data/evaluation/phastCons100way.bed.gz \\\n  -p data/evaluation/phastCons100way.parquet \\\n  -y data/evaluation/phyloP100way.parquet \\\n  -R data/fasta/test.fa\n</code></pre> <p>4) Fit EM model</p> <pre><code>accmix model \\\n  -i results/M00124_example_annotated.parquet \\\n  -o results/RBP_Motif \\\n  -r ExampleRBP \\\n  -m M00124\n</code></pre> <p>5) Evaluate</p> <p>Run evaluation directly on the model parquet:</p> <pre><code>accmix evaluate \\\n  -M results/RBP_Motif.XXXXXX.model.parquet \\\n  -b data/clipseq/ELAVL1_HeLa.bed \\\n  -p data/evaluation/PIPseq_HeLa.parquet \\\n  -r ExampleRBP \\\n  -m M00124 \\\n  -o results \\\n  -L data/logos/M00124_fwd.png \\\n  -t 1.0 \\\n  -R 50\n</code></pre> <p>Outputs include evaluation plots and tables. Example artifacts from this repo:</p> <ul> <li>Heatmap: <code>assets/figures/ExampleRBP_M00124_heatmap_with_title_logo.png</code></li> <li>Distribution: <code>assets/figures/ExampleRBP_M00124.dist.val.png</code></li> </ul>"},{"location":"reproducibility/#batch-runs-used-for-figures","title":"Batch runs used for figures","text":"<p>The figures in this repository were generated by running two batch scripts from the repo root:</p> <p>1) Fit models across Midway3 parquets</p> <pre><code>python scripts/run_accmix_models_over_midway3_results.py\n</code></pre> <ul> <li>Discovers <code>data/midway3_results/*.parquet</code> and matching CLIP beds.</li> <li>Calls <code>accmix model</code> internals for each RBP/motif pair.</li> <li>Writes per-run model parquet/JSON into <code>results/</code>.</li> </ul> <p>2) Evaluate all fitted models</p> <pre><code>python scripts/run_accmix_evaluation_over_midway3_results.py\n</code></pre> <ul> <li>For each RBP/motif pair, finds the latest <code>results/&lt;RBP&gt;_&lt;Motif&gt;*.model.parquet</code>.</li> <li>Invokes <code>accmix evaluate -M &lt;model.parquet&gt; -b &lt;CLIP.bed&gt; -p &lt;pipseq.parquet&gt; -r &lt;RBP&gt; -m &lt;Motif&gt;</code>.</li> <li>Plots and logs are written under <code>results/plots/</code> and <code>results/logs/</code>.</li> </ul> <p>Running these two scripts sequentially reproduces the model fits and evaluation plots shown in the repository.</p> <p>Rendered examples:</p> <p></p> <p></p>"},{"location":"tutorial/","title":"Tutorial","text":"<p>This tutorial walks through the full workflow: scan PWM \u2192 annotate accessibility (AS) \u2192 annotate TSS/conservation/TPM \u2192 fit EM model \u2192 evaluation.</p>"},{"location":"tutorial/#1-scan-pwm-and-gc","title":"1) Scan PWM and GC","text":"<p>Scan the genome FASTA with a PWM and compute GC content per region.</p> <pre><code>accmix scan \\\n  -f data/fasta/test.fa \\\n  -p data/pwms/M00124_example.txt \\\n  -o results/M00124_example\n</code></pre> <p>Outputs:</p> <ul> <li><code>results/M00124_example_topA.tsv.gz</code></li> <li><code>results/M00124_example_botB.tsv.gz</code></li> </ul>"},{"location":"tutorial/#2-annotate-accessibility-compute-s_l","title":"2) Annotate accessibility (compute s_l)","text":"<p>Compute accessibility-derived site score <code>s_l</code> using native vs. fixed alignments and PWM toptables.</p> <pre><code>accmix annotate-acc \\\n  -n data/AS/ANC1C.hisat3n_table.bed6 \\\n  -f data/AS/ANC1xC.hisat3n_table.bed6 \\\n  -t results/M00124_example_topA.tsv.gz \\\n  -o results/M00124_example_sl.parquet \\\n  --M 50 \\\n  --N 500\n</code></pre> <p>Notes:</p> <ul> <li><code>--M</code> is the inner flank; <code>--N</code> is the outer flank; outer flank length = <code>N - M</code>.</li> </ul>"},{"location":"tutorial/#3-annotate-tss-conservation-tpm","title":"3) Annotate TSS / conservation / TPM","text":"<p>Join transcript/TSS proximity, conservation (phastCons/phyloP), and RNA-seq TPM to each site.</p> <pre><code>accmix annotate-tss \\\n  -i results/M00124_example_sl.parquet \\\n  -o results/M00124_example_annotated.parquet \\\n  -r data/evaluation/RNAseq_HeLa_TPM.parquet \\\n  -c data/evaluation/phastCons100way.bed.gz \\\n  -p data/evaluation/phastCons100way.parquet \\\n  -y data/evaluation/phyloP100way.parquet \\\n  -R data/fasta/test.fa\n</code></pre>"},{"location":"tutorial/#4-fit-em-model-gaussian-logistic-prior","title":"4) Fit EM model (Gaussian + logistic prior)","text":"<p>Fit the mixture model and write posterior probabilities and model parameters.</p> <pre><code>accmix model \\\n  -i results/M00124_example_annotated.parquet \\\n  -o results/RBP_Motif \\\n  -r ExampleRBP \\\n  -m M00124\n</code></pre> <p>Outputs:</p> <ul> <li><code>results/RBP_Motif.XXXXXX.model.parquet</code> (data with <code>prior_p</code>, <code>posterior_r</code>)</li> <li><code>results/RBP_Motif.XXXXXX.model.json</code> (fitted parameters)</li> </ul>"},{"location":"tutorial/#5-evaluation","title":"5) Evaluation","text":"<p>Evaluate the fitted model against external assays (e.g., CLIP/PIPseq) via the <code>evaluate</code> subcommand using the model parquet.</p> <pre><code>accmix evaluate \\\n  -M results/RBP_Motif.XXXXXX.model.parquet \\\n  -b data/clipseq/ELAVL1_HeLa.bed \\\n  -p data/evaluation/PIPseq_HeLa.parquet \\\n  -r ExampleRBP \\\n  -m M00124 \\\n  -o results \\\n  -L data/logos/M00124_fwd.png \\\n  -t 1.0 \\\n  -R 50\n</code></pre> <p>This writes plots/tables under <code>results/</code> for downstream analysis.</p>"}]}